#include <windows.h>
#include "msvbvm60.tlh" 

//the tlh and tli files were generated by 
//#import <msvbvm60.dll> no_namespace
//then we manually modified them to only include the collection object
//and now import them manually. (they gave compile error as auto generated)
//they give us the smart pointer definition for _CollectionPtr

#define EXPORT comment(linker, "/EXPORT:"__FUNCTION__"="__FUNCDNAME__)
 
void addStr(_CollectionPtr p , char* str){
	_variant_t vv;
	vv.SetString(str);
	//VARIANT v = vv.Detach(); //this leads to a memory leak dont use..
	//p->Add(&v);
	p->Add(&vv.GetVARIANT());
}

void addInt(_CollectionPtr p , int d){
	_variant_t vv;
	vv.intVal = d;
	vv.vt = VT_I4;
	p->Add(&vv.GetVARIANT());
}

void __stdcall addItems(_CollectionPtr *pColl)
{
#pragma EXPORT
	
	addStr(*pColl, "this is my string1");
	addStr(*pColl, "this is my string2");
	addStr(*pColl, "this is my string3");
	addStr(*pColl, "this is my string4");
	addInt(*pColl, 5 );
}
